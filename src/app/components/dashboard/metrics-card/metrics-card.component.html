<div class="metrics-container">
  @let loading = (loading$ | async);
  @let error = (error$ | async);
  @if (!loading && !error) {
    <mat-card class="metric-card">
      <mat-card-header>
        <mat-icon mat-card-avatar>people</mat-icon>
        <mat-card-title>Total Active Users</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="metric-value">{{ metrics.totalActiveUsers | number }}</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-header>
        <mat-icon mat-card-avatar>schedule</mat-icon>
        <mat-card-title>Avg Session Duration</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="metric-value">{{ metrics.averageSessionDuration | duration }}</div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-header>
        <mat-icon mat-card-avatar>trending_up</mat-icon>
        <mat-card-title>Conversion Rate</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="metric-value">{{ (metrics.conversionRate * 100) | number:'1.0-1' }}<span class="unit">%</span></div>
      </mat-card-content>
    </mat-card>

    <mat-card class="metric-card">
      <mat-card-header>
        <mat-icon mat-card-avatar>attach_money</mat-icon>
        <mat-card-title>Revenue Today</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="metric-value">${{ metrics.revenueToday | number:'1.0-2' }}</div>
      </mat-card-content>
    </mat-card>
  } @else {
    @if (loading) {
      <div class="state">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading metricsâ€¦</p>
      </div>
    }
    @if (error) {
      <mat-card class="error-card">
        <mat-card-content>
          <mat-icon color="warn">error</mat-icon>
          <p>{{ error }}</p>
        </mat-card-content>
      </mat-card>
    }
  }
</div>
